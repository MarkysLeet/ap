(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{5458:function(a,e,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account",function(){return c(898)}])},898:function(a,e,c){"use strict";c.r(e);var s=c(5893),t=c(7294),n=c(1163),l=c(3207),d=c(1286),i=c(97),r=c(5099),o=c(1187),u=c(3625),v=c(3218),h=c.n(v);let m=[{id:"profile",label:"Профиль"},{id:"address",label:"Адрес доставки"},{id:"orders",label:"История покупок"},{id:"security",label:"Безопасность"}],f="avenue-account-profile",p="avenue-account-security",b={firstName:"",lastName:"",phone:""},_={email:"",backupPhone:"",passwordUpdatedAt:""},createEmptyAddress=()=>({id:"",label:"",country:"",city:"",street:"",postalCode:"",isDefault:!1}),j=[{orderNo:"AV-2027",date:"12.08.2024",status:"В обработке",total:2680,items:[{productId:"klassicheskaya-seriya-gel-lakov-01",quantity:1},{productId:"klassicheskaya-seriya-gel-lakov-02",quantity:1}]},{orderNo:"AV-1998",date:"02.07.2024",status:"Отправлен",total:8140,items:[{productId:"frezer-dlya-manikyura",quantity:1},{productId:"consumable-wipes",quantity:2}]},{orderNo:"AV-1875",date:"18.05.2024",status:"Доставлен",total:3940,items:[{productId:"gel-sculptor",quantity:1},{productId:"poly-flex",quantity:1}]}],x={"В обработке":"processing",Отправлен:"shipped",Доставлен:"delivered",Отменён:"cancelled"};e.default=()=>{let a=(0,n.useRouter)(),{push:e,replace:c,query:v}=a,{user:N,isAuthenticated:g,updateProfile:y,changeEmail:P,changePassword:A}=(0,d.a)(),{addToCart:w}=(0,i.j)(),{toast:k}=(0,r.pm)(),[S,C]=(0,t.useState)("profile"),D=(0,t.useRef)([]),E=(0,t.useRef)(!1),I=(0,t.useRef)(null),q=(0,t.useRef)(!1),[T,U]=(0,t.useState)(b),[z,R]=(0,t.useState)(b),[O,H]=(0,t.useState)(null),[J,B]=(0,t.useState)(_),[L,V]=(0,t.useState)({email:"",backupPhone:"",oldPassword:"",newPassword:"",confirmPassword:""}),[K,G]=(0,t.useState)(null),[Y,Z]=(0,t.useState)(""),[M,X]=(0,t.useState)([]),[F,Q]=(0,t.useState)(createEmptyAddress()),[W,$]=(0,t.useState)(null),[aa,ae]=(0,t.useState)(!1),[ac,as]=(0,t.useState)(null);(0,t.useEffect)(()=>{g||E.current||(E.current=!0,k({type:"warning",message:"Требуется авторизация для доступа к личному кабинету",actionLabel:"Войти",onAction:()=>e("/auth/login?returnTo=/account")}),c("/auth/login?returnTo=/account"))},[g,e,c,k]),(0,t.useEffect)(()=>{try{let a=window.localStorage.getItem(f);if(a){let e=JSON.parse(a);U({...b,...e}),R({...b,...e})}}catch(a){console.warn("Ошибка чтения профиля",a)}try{let a=window.localStorage.getItem(p);if(a){let e=JSON.parse(a);B({..._,...e}),V(a=>({...a,...e}))}}catch(a){console.warn("Ошибка чтения настроек безопасности",a)}let a=(0,u.y)((0,u.zz)().addresses);X(a.addresses),q.current=!0},[]),(0,t.useEffect)(()=>{if(q.current)try{window.localStorage.setItem(f,JSON.stringify(T))}catch(a){console.warn("Ошибка сохранения профиля",a)}},[T]),(0,t.useEffect)(()=>{if(q.current)try{window.localStorage.setItem(p,JSON.stringify({email:J.email,backupPhone:J.backupPhone,passwordUpdatedAt:J.passwordUpdatedAt}))}catch(a){console.warn("Ошибка сохранения настроек безопасности",a)}},[J.email,J.backupPhone,J.passwordUpdatedAt]),(0,t.useEffect)(()=>{q.current&&(0,u.H7)(M)},[M]),(0,t.useEffect)(()=>{N&&(U(a=>{let e={...a};if(!e.firstName&&(N.firstName?e.firstName=N.firstName:N.name&&(e.firstName=N.name.split(" ")[0])),!e.lastName&&N.lastName)e.lastName=N.lastName;else if(!e.lastName&&N.name&&N.name.includes(" ")){let[,...a]=N.name.split(" ");e.lastName=a.join(" ")}return!e.phone&&N.phone&&(e.phone=N.phone),e}),R(a=>({...a,firstName:a.firstName||N.firstName||(N.name?N.name.split(" ")[0]:""),lastName:a.lastName||N.lastName||"",phone:a.phone||N.phone||""})),B(a=>({...a,email:a.email||N.email||"",backupPhone:a.backupPhone||N.phone||""})),V(a=>({...a,email:a.email||N.email||"",backupPhone:a.backupPhone||N.phone||""})))},[N]),(0,t.useEffect)(()=>{let{tab:a}=v;"string"==typeof a&&m.some(e=>e.id===a)&&C(a)},[v]),(0,t.useEffect)(()=>()=>{I.current&&clearTimeout(I.current)},[]);let handleTabKeyDown=(e,c)=>{if("ArrowRight"!==e.key&&"ArrowLeft"!==e.key)return;e.preventDefault();let s="ArrowRight"===e.key?1:-1,t=(c+s+m.length)%m.length,n=m[t];C(n.id),a.replace({pathname:"/account",query:"profile"===n.id?{}:{tab:n.id}},void 0,{shallow:!0}),D.current[t]&&D.current[t].focus()},handleTabClick=e=>{C(e.id),a.replace({pathname:"/account",query:"profile"===e.id?{}:{tab:e.id}},void 0,{shallow:!0})},beginProfileEdit=a=>{R(T),H(a)},cancelProfileEdit=()=>{R(T),H(null)},handleProfileDraftChange=a=>{let{name:e,value:c}=a.target;R(a=>({...a,[e]:c}))},handleProfileSubmit=a=>{if(a.preventDefault(),O)try{if("name"===O){let a={firstName:z.firstName.trim(),lastName:z.lastName.trim()},e=[a.firstName,a.lastName].filter(Boolean).join(" ").trim();y({...a,name:e||(null==N?void 0:N.name)||"",phone:T.phone}),U(e=>({...e,...a})),k({type:"success",message:"Данные профиля обновлены"})}else if("phone"===O){let a={phone:z.phone.trim()},e=[T.firstName,T.lastName].filter(Boolean).join(" ").trim();y({...a,name:e||(null==N?void 0:N.name)||"",firstName:T.firstName,lastName:T.lastName}),U(e=>({...e,...a})),B(e=>({...e,backupPhone:a.phone})),V(e=>({...e,backupPhone:a.phone})),k({type:"success",message:"Телефон обновлён"})}H(null)}catch(a){k({type:"error",message:a.message})}},beginSecurityEdit=a=>{V(a=>({...a,email:J.email,backupPhone:J.backupPhone,oldPassword:"",newPassword:"",confirmPassword:""})),Z(""),G(a)},cancelSecurityEdit=()=>{Z(""),G(null),V(a=>({...a,email:J.email,backupPhone:J.backupPhone,oldPassword:"",newPassword:"",confirmPassword:""}))},handleSecurityDraftChange=a=>{let{name:e,value:c}=a.target;V(a=>({...a,[e]:c}))},handleSecuritySubmit=a=>{if(a.preventDefault(),K)try{if("email"===K){let a=P(L.email.trim());B(e=>({...e,email:a.email})),k({type:"success",message:"Email обновлён"})}else if("backupPhone"===K)B(a=>({...a,backupPhone:L.backupPhone.trim()})),k({type:"success",message:"Телефон для восстановления обновлён"});else if("password"===K){if(L.newPassword!==L.confirmPassword){Z("Подтверждение пароля не совпадает");return}A({oldPassword:L.oldPassword,newPassword:L.newPassword}),B(a=>({...a,passwordUpdatedAt:new Date().toLocaleDateString("ru-RU")})),k({type:"success",message:"Пароль успешно изменён"})}G(null),Z("")}catch(a){Z(a.message)}},beginAddAddress=()=>{Q(createEmptyAddress()),ae(!0),$(null)},beginEditAddress=a=>{Q({...a}),$(a.id),ae(!1)},handleAddressDraftChange=a=>{let{name:e,value:c}=a.target;Q(a=>({...a,[e]:c}))},handleMakeDefaultAddress=a=>{let e=(0,u.y)(M.map(e=>({...e,isDefault:e.id===a})));X(e.addresses),k({type:"success",message:"Адрес по умолчанию обновлён"})},handleDeleteAddress=a=>{let e=M.filter(e=>e.id!==a),c=(0,u.y)(e);X(c.addresses),k({type:"success",message:"Адрес удалён"})},handleReorder=a=>{a.items.forEach(a=>{let{productId:e,quantity:c}=a,s=o.RB.find(a=>a.id===e);s&&w(s,c)}),as(a.orderNo),I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{as(null)},1200),k({type:"success",message:"Товары заказа ".concat(a.orderNo," добавлены в корзину")})};return(0,s.jsx)(l.Z,{title:"Личный кабинет — Avenue Professional",children:g?(0,s.jsxs)("section",{className:h()["av-account-section"],children:[(0,s.jsxs)("header",{className:h()["av-account-header"],children:[(0,s.jsx)("h1",{children:"Личный кабинет"}),(0,s.jsx)("p",{children:"Управляйте профилем, заказами и настройками безопасности в одном месте."})]}),(0,s.jsx)("div",{role:"tablist",className:h()["av-account-tabs"],children:m.map((a,e)=>(0,s.jsx)("button",{role:"tab",ref:a=>{D.current[e]=a},"aria-selected":S===a.id,"aria-controls":"panel-".concat(a.id),className:S===a.id?"".concat(h()["av-account-tab"]," ").concat(h()["av-account-tab-active"]):h()["av-account-tab"],onClick:()=>handleTabClick(a),onKeyDown:a=>handleTabKeyDown(a,e),children:a.label},a.id))}),(0,s.jsxs)("div",{id:"panel-".concat(S),role:"tabpanel","aria-labelledby":S,className:h()["av-account-panel"],children:["profile"===S&&(0,s.jsxs)("div",{className:h()["av-account-card"],children:[(0,s.jsx)("div",{className:h()["av-account-card-header"],children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Основная информация"}),(0,s.jsx)("p",{children:"Здесь вы управляете личными данными, которые видны в заказах."})]})}),(0,s.jsx)("div",{className:h()["av-account-card-body"],children:(0,s.jsxs)("div",{className:h()["av-account-info-grid"],children:[(0,s.jsxs)("div",{className:h()["av-field"],children:[(0,s.jsxs)("div",{className:h()["av-field-view"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:h()["av-account-info-label"],children:"Имя и фамилия"}),(0,s.jsx)("p",{className:h()["av-account-info-value"],children:[T.firstName,T.lastName].filter(Boolean).join(" ")||"Не указано"})]}),(0,s.jsx)("button",{type:"button",className:h()["av-field-edit"],onClick:()=>beginProfileEdit("name"),children:"Изменить"})]}),"name"===O?(0,s.jsxs)("form",{className:h()["av-inline-form"],onSubmit:handleProfileSubmit,children:[(0,s.jsxs)("div",{className:h()["av-account-grid"],children:[(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Имя",(0,s.jsx)("input",{name:"firstName",value:z.firstName,onChange:handleProfileDraftChange,placeholder:"Имя"})]}),(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Фамилия",(0,s.jsx)("input",{name:"lastName",value:z.lastName,onChange:handleProfileDraftChange,placeholder:"Фамилия"})]})]}),(0,s.jsxs)("div",{className:h()["av-account-actions"],children:[(0,s.jsx)("button",{type:"submit",className:h()["av-account-save"],children:"Сохранить"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:cancelProfileEdit,children:"Отмена"})]})]}):null]}),(0,s.jsxs)("div",{className:h()["av-field"],children:[(0,s.jsxs)("div",{className:h()["av-field-view"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:h()["av-account-info-label"],children:"Телефон"}),(0,s.jsx)("p",{className:h()["av-account-info-value"],children:T.phone||"Не указан"})]}),(0,s.jsx)("button",{type:"button",className:h()["av-field-edit"],onClick:()=>beginProfileEdit("phone"),children:"Изменить"})]}),"phone"===O?(0,s.jsxs)("form",{className:h()["av-inline-form"],onSubmit:handleProfileSubmit,children:[(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Телефон",(0,s.jsx)("input",{name:"phone",value:z.phone,onChange:handleProfileDraftChange,placeholder:"+7 (___) ___-__-__"})]}),(0,s.jsxs)("div",{className:h()["av-account-actions"],children:[(0,s.jsx)("button",{type:"submit",className:h()["av-account-save"],children:"Сохранить"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:cancelProfileEdit,children:"Отмена"})]})]}):null]})]})})]}),"address"===S&&(0,s.jsxs)("div",{className:h()["av-account-stack"],children:[(0,s.jsxs)("div",{className:h()["av-account-card"],children:[(0,s.jsxs)("div",{className:h()["av-account-card-header"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Сохранённые адреса"}),(0,s.jsx)("p",{children:"Управляйте вариантами доставки, выбирайте основной адрес."})]}),(0,s.jsx)("button",{type:"button",className:h()["av-edit-btn"],onClick:beginAddAddress,children:"Добавить адрес"})]}),(0,s.jsx)("div",{className:h()["av-account-card-body"],children:0===M.length?(0,s.jsxs)("div",{className:h()["av-account-empty"],children:[(0,s.jsx)("p",{children:"Пока нет сохранённых адресов. Добавьте первый, чтобы ускорить оформление."}),(0,s.jsx)("button",{type:"button",className:h()["av-account-save"],onClick:beginAddAddress,children:"Добавить адрес"})]}):(0,s.jsx)("div",{className:h()["av-address-grid"],children:M.map(a=>(0,s.jsxs)("div",{className:h()["av-address-card"],children:[(0,s.jsxs)("div",{className:h()["av-address-head"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:h()["av-account-info-label"],children:a.label}),(0,s.jsx)("p",{className:h()["av-account-info-value"],children:[a.country,a.city,a.street].filter(Boolean).join(", ")||"Не заполнено"})]}),a.isDefault?(0,s.jsx)("span",{className:h()["av-address-badge"],children:"По умолчанию"}):null]}),(0,s.jsxs)("div",{className:h()["av-address-body"],children:[(0,s.jsxs)("p",{className:h()["av-address-line"],children:[(0,s.jsx)("span",{children:"Страна:"})," ",a.country||"—"]}),(0,s.jsxs)("p",{className:h()["av-address-line"],children:[(0,s.jsx)("span",{children:"Город:"})," ",a.city||"—"]}),(0,s.jsxs)("p",{className:h()["av-address-line"],children:[(0,s.jsx)("span",{children:"Улица / дом / кв.:"})," ",a.street||"—"]}),(0,s.jsxs)("p",{className:h()["av-address-line"],children:[(0,s.jsx)("span",{children:"Индекс:"})," ",a.postalCode||"—"]})]}),(0,s.jsxs)("div",{className:h()["av-address-actions"],children:[a.isDefault?null:(0,s.jsx)("button",{type:"button",className:h()["av-account-save"],onClick:()=>handleMakeDefaultAddress(a.id),children:"Сделать основным"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:()=>beginEditAddress(a),children:"Редактировать"}),(0,s.jsx)("button",{type:"button",className:h()["av-address-remove"],onClick:()=>handleDeleteAddress(a.id),children:"Удалить"})]})]},a.id))})})]}),(aa||W)&&(0,s.jsxs)("div",{className:h()["av-account-card"],children:[(0,s.jsx)("div",{className:h()["av-account-card-header"],children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:W?"Редактирование адреса":"Новый адрес"}),(0,s.jsx)("p",{children:"Заполните поля и сохраните, чтобы адрес появился в списке."})]})}),(0,s.jsxs)("form",{className:h()["av-account-card-body"],onSubmit:a=>{a.preventDefault();let e={...F,label:F.label.trim()||"Адрес ".concat(M.length+1),country:F.country.trim(),city:F.city.trim(),street:F.street.trim(),postalCode:F.postalCode.trim()},c=[];if(W)c=M.map(a=>a.id===W?{...a,...e,id:W}:a),k({type:"success",message:"Адрес обновлён"});else{let a="address-".concat(Date.now()),s={...e,id:a,isDefault:0===M.length};c=[...M,s],k({type:"success",message:"Адрес добавлен"})}let s=(0,u.y)(c);X(s.addresses),Q(createEmptyAddress()),$(null),ae(!1)},children:[(0,s.jsxs)("div",{className:h()["av-account-grid"],children:[(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Название адреса",(0,s.jsx)("input",{name:"label",value:F.label,onChange:handleAddressDraftChange,placeholder:"Например, Дом или Салон",required:!0})]}),(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Страна",(0,s.jsx)("input",{name:"country",value:F.country,onChange:handleAddressDraftChange,placeholder:"Россия"})]}),(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Город",(0,s.jsx)("input",{name:"city",value:F.city,onChange:handleAddressDraftChange,placeholder:"Москва"})]}),(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Индекс",(0,s.jsx)("input",{name:"postalCode",value:F.postalCode,onChange:handleAddressDraftChange,placeholder:"123456"})]})]}),(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Улица, дом, квартира",(0,s.jsx)("input",{name:"street",value:F.street,onChange:handleAddressDraftChange,placeholder:"Укажите полный адрес"})]}),(0,s.jsxs)("div",{className:h()["av-account-actions"],children:[(0,s.jsx)("button",{type:"submit",className:h()["av-account-save"],children:"Сохранить"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:()=>{Q(createEmptyAddress()),$(null),ae(!1)},children:"Отмена"})]})]})]})]}),"orders"===S&&(0,s.jsxs)("div",{className:h()["av-account-card"],children:[(0,s.jsx)("div",{className:h()["av-account-card-header"],children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"История покупок"}),(0,s.jsx)("p",{children:"Следите за статусами и повторяйте понравившиеся заказы."})]})}),(0,s.jsx)("div",{className:h()["av-account-card-body"],children:(0,s.jsxs)("table",{className:h()["av-account-orders"],children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Номер"}),(0,s.jsx)("th",{children:"Дата"}),(0,s.jsx)("th",{children:"Статус"}),(0,s.jsx)("th",{children:"Сумма"}),(0,s.jsx)("th",{"aria-hidden":"true"})]})}),(0,s.jsx)("tbody",{children:j.map(a=>(0,s.jsxs)("tr",{className:"".concat(h()["av-account-order-row"]," ").concat(ac===a.orderNo?h()["av-account-order-row-active"]:""),children:[(0,s.jsx)("td",{children:a.orderNo}),(0,s.jsx)("td",{children:a.date}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"".concat(h()["av-account-status"]," ").concat(h()["av-account-status-".concat(x[a.status])]),children:a.status})}),(0,s.jsxs)("td",{children:[a.total.toLocaleString()," ₺"]}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{type:"button",className:h()["av-account-order-action"],onClick:()=>handleReorder(a),children:"Повторить заказ"})})]},a.orderNo))})]})})]}),"security"===S&&(0,s.jsxs)("div",{className:h()["av-account-stack"],children:[(0,s.jsxs)("div",{className:h()["av-account-card"],children:[(0,s.jsx)("div",{className:h()["av-account-card-header"],children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Контакты для входа"}),(0,s.jsx)("p",{children:"Управляйте email и резервным телефоном для восстановления доступа."})]})}),(0,s.jsxs)("div",{className:h()["av-account-card-body"],children:[(0,s.jsxs)("div",{className:h()["av-field"],children:[(0,s.jsxs)("div",{className:h()["av-field-view"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:h()["av-account-info-label"],children:"Email"}),(0,s.jsx)("p",{className:h()["av-account-info-value"],children:J.email||"Не указан"})]}),(0,s.jsx)("button",{type:"button",className:h()["av-field-edit"],onClick:()=>beginSecurityEdit("email"),children:"Изменить"})]}),"email"===K?(0,s.jsxs)("form",{className:h()["av-inline-form"],onSubmit:handleSecuritySubmit,children:[(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Новый email",(0,s.jsx)("input",{type:"email",name:"email",value:L.email,onChange:handleSecurityDraftChange,required:!0})]}),(0,s.jsxs)("div",{className:h()["av-account-actions"],children:[(0,s.jsx)("button",{type:"submit",className:h()["av-account-save"],children:"Сохранить"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:cancelSecurityEdit,children:"Отмена"})]}),Y?(0,s.jsx)("p",{className:h()["av-account-feedback"],children:Y}):null]}):null]}),(0,s.jsxs)("div",{className:h()["av-field"],children:[(0,s.jsxs)("div",{className:h()["av-field-view"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:h()["av-account-info-label"],children:"Телефон для восстановления"}),(0,s.jsx)("p",{className:h()["av-account-info-value"],children:J.backupPhone||"Не указан"})]}),(0,s.jsx)("button",{type:"button",className:h()["av-field-edit"],onClick:()=>beginSecurityEdit("backupPhone"),children:"Изменить"})]}),"backupPhone"===K?(0,s.jsxs)("form",{className:h()["av-inline-form"],onSubmit:handleSecuritySubmit,children:[(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Телефон",(0,s.jsx)("input",{type:"tel",name:"backupPhone",value:L.backupPhone,onChange:handleSecurityDraftChange})]}),(0,s.jsxs)("div",{className:h()["av-account-actions"],children:[(0,s.jsx)("button",{type:"submit",className:h()["av-account-save"],children:"Сохранить"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:cancelSecurityEdit,children:"Отмена"})]}),Y?(0,s.jsx)("p",{className:h()["av-account-feedback"],children:Y}):null]}):null]})]})]}),(0,s.jsxs)("div",{className:h()["av-account-card"],children:[(0,s.jsx)("div",{className:h()["av-account-card-header"],children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Пароль"}),(0,s.jsx)("p",{children:"Измените пароль для входа. После сохранения появится отметка о последнем обновлении."})]})}),(0,s.jsx)("div",{className:h()["av-account-card-body"],children:(0,s.jsxs)("div",{className:h()["av-field"],children:[(0,s.jsxs)("div",{className:h()["av-field-view"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:h()["av-account-info-label"],children:"Статус"}),(0,s.jsx)("p",{className:h()["av-account-info-value"],children:J.passwordUpdatedAt?"Обновлён ".concat(J.passwordUpdatedAt):"Ещё не обновлялся"})]}),(0,s.jsx)("button",{type:"button",className:h()["av-field-edit"],onClick:()=>beginSecurityEdit("password"),children:"Изменить"})]}),"password"===K?(0,s.jsxs)("form",{className:h()["av-inline-form"],onSubmit:handleSecuritySubmit,children:[(0,s.jsxs)("div",{className:h()["av-account-grid"],children:[(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Текущий пароль",(0,s.jsx)("input",{type:"password",name:"oldPassword",value:L.oldPassword,onChange:handleSecurityDraftChange,required:!0})]}),(0,s.jsxs)("label",{className:h()["av-account-field"],children:["Новый пароль",(0,s.jsx)("input",{type:"password",name:"newPassword",value:L.newPassword,onChange:handleSecurityDraftChange,required:!0})]}),(0,s.jsxs)("label",{className:"".concat(h()["av-account-field"]," ").concat(h()["av-account-field-span"]),children:["Подтверждение",(0,s.jsx)("input",{type:"password",name:"confirmPassword",value:L.confirmPassword,onChange:handleSecurityDraftChange,required:!0})]})]}),(0,s.jsxs)("div",{className:h()["av-account-actions"],children:[(0,s.jsx)("button",{type:"submit",className:h()["av-account-save"],children:"Сохранить"}),(0,s.jsx)("button",{type:"button",className:h()["av-account-cancel"],onClick:cancelSecurityEdit,children:"Отмена"})]}),Y?(0,s.jsx)("p",{className:h()["av-account-feedback"],children:Y}):null]}):null]})})]})]})]})]}):null})}},3625:function(a,e,c){"use strict";c.d(e,{H7:function(){return writeAddresses},y:function(){return ensureDefaultAddress},zz:function(){return readAddresses}});let s="avenue-account-addresses",t={addresses:[],defaultId:null},normalizeAddress=(a,e)=>({id:a.id||"address-".concat(Date.now(),"-").concat(e),label:a.label||"Адрес",country:a.country||"",city:a.city||"",street:a.street||"",postalCode:a.postalCode||"",isDefault:!!a.isDefault}),readAddresses=()=>{let a=window.localStorage.getItem(s);if(!a)return t;try{var e,c,n,l;let s=JSON.parse(a);if(Array.isArray(s)){let a=s.map(normalizeAddress),t=(null===(e=a.find(a=>a.isDefault))||void 0===e?void 0:e.id)||(null===(c=a[0])||void 0===c?void 0:c.id)||null;return{addresses:a.map(a=>({...a,isDefault:a.id===t})),defaultId:t}}if(s&&Array.isArray(s.addresses)){let a=s.addresses.map(normalizeAddress),e=s.defaultId||(null===(n=a.find(a=>a.isDefault))||void 0===n?void 0:n.id)||(null===(l=a[0])||void 0===l?void 0:l.id)||null;return{addresses:a.map(a=>({...a,isDefault:a.id===e})),defaultId:e}}if(s&&"object"==typeof s){let a=normalizeAddress(s,0);return{addresses:[{...a,isDefault:!0}],defaultId:a.id}}}catch(a){console.warn("Ошибка чтения адресов",a)}return t},writeAddresses=a=>{var e,c;let t=a.map((a,e)=>normalizeAddress(a,e)),n=(null===(e=t.find(a=>a.isDefault))||void 0===e?void 0:e.id)||(null===(c=t[0])||void 0===c?void 0:c.id)||null,l={addresses:t.map(a=>({...a,isDefault:a.id===n})),defaultId:n};window.localStorage.setItem(s,JSON.stringify(l))},ensureDefaultAddress=a=>{if(!Array.isArray(a)||0===a.length)return{addresses:[],defaultId:null};let e=a.find(a=>a.isDefault);if(e)return{addresses:a.map(a=>({...a,isDefault:a.id===e.id})),defaultId:e.id};let[c,...s]=a;return{addresses:[{...c,isDefault:!0},...s.map(a=>({...a,isDefault:!1}))],defaultId:c.id}}},3218:function(a){a.exports={"av-account-section":"AccountPage_av-account-section__bzECx","av-account-header":"AccountPage_av-account-header__L3fKh","av-account-tabs":"AccountPage_av-account-tabs__QPtny","av-account-tab":"AccountPage_av-account-tab__0Tbds","av-account-tab-active":"AccountPage_av-account-tab-active__DHHLO","av-account-panel":"AccountPage_av-account-panel__iSZQp","av-account-stack":"AccountPage_av-account-stack__UEqct","av-account-card":"AccountPage_av-account-card__xbE6R","av-account-card-header":"AccountPage_av-account-card-header__szGei","av-edit-btn":"AccountPage_av-edit-btn__h5uke","av-account-card-body":"AccountPage_av-account-card-body__zHCwD","av-account-fade":"AccountPage_av-account-fade__GePSa","av-account-card-body-view":"AccountPage_av-account-card-body-view__jufvT","av-account-card-body-edit":"AccountPage_av-account-card-body-edit__PHbgJ","av-account-zoom":"AccountPage_av-account-zoom__EPwxx","av-account-info-grid":"AccountPage_av-account-info-grid__EsFgh","av-field":"AccountPage_av-field__1DEX8","av-field-view":"AccountPage_av-field-view__r3SUE","av-field-edit":"AccountPage_av-field-edit__ners_","av-account-info-item":"AccountPage_av-account-info-item__rTaDF","av-account-info-label":"AccountPage_av-account-info-label__JVmiX","av-account-info-value":"AccountPage_av-account-info-value__UDj5h","av-account-actions":"AccountPage_av-account-actions__AAxol","av-account-cancel":"AccountPage_av-account-cancel__60WOi","av-account-form":"AccountPage_av-account-form__GMljw","av-account-grid":"AccountPage_av-account-grid__9bb1J","av-account-grid-single":"AccountPage_av-account-grid-single__MqD_0","av-account-field":"AccountPage_av-account-field__bcvUS","av-account-field-span":"AccountPage_av-account-field-span__lH5VS","av-account-save":"AccountPage_av-account-save__YOvH4","av-account-feedback":"AccountPage_av-account-feedback__B_7bE","av-inline-form":"AccountPage_av-inline-form__AUaoL","av-address-grid":"AccountPage_av-address-grid__ra18Z","av-address-card":"AccountPage_av-address-card__5GUKP","av-address-head":"AccountPage_av-address-head__qxZ0e","av-address-badge":"AccountPage_av-address-badge__5doVc","av-address-body":"AccountPage_av-address-body__fWtry","av-address-line":"AccountPage_av-address-line__UCG13","av-address-actions":"AccountPage_av-address-actions__e3KoY","av-address-remove":"AccountPage_av-address-remove__YTxez","av-account-orders":"AccountPage_av-account-orders__HgOkR","av-account-order-row":"AccountPage_av-account-order-row__5lRtd","av-account-order-row-active":"AccountPage_av-account-order-row-active__1YUaY","av-account-row-glow":"AccountPage_av-account-row-glow__V6sLa","av-account-status":"AccountPage_av-account-status__3qge7","av-account-status-processing":"AccountPage_av-account-status-processing__6aT5m","av-account-status-shipped":"AccountPage_av-account-status-shipped__9tBCf","av-account-status-delivered":"AccountPage_av-account-status-delivered__8a0bE","av-account-status-cancelled":"AccountPage_av-account-status-cancelled__3_BdN","av-account-order-action":"AccountPage_av-account-order-action__TZ5V9","av-account-favorites-grid":"AccountPage_av-account-favorites-grid__AR_Si","av-account-empty":"AccountPage_av-account-empty__yIuNF","av-account-empty-link":"AccountPage_av-account-empty-link__hUxEr"}}},function(a){a.O(0,[998,207,187,774,888,179],function(){return a(a.s=5458)}),_N_E=a.O()}]);