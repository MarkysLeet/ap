(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{8693:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products/[id]",function(){return a(81)}])},1622:function(e,t,a){"use strict";let r;var c=a(5893),n=a(1664),i=a.n(n),s=a(5675),o=a.n(s),l=a(1163),u=a(3935),d=a(7294),v=a(97),_=a(8290),p=a(1286),m=a(5099),f=a(2637),g=a.n(f);let getCardObserver=()=>(r||(r=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-inview"),r&&r.unobserve(e.target))})},{threshold:.15})),r);t.Z=e=>{var t,a;let{product:r,className:n=""}=e,s=(0,l.useRouter)(),{items:f,addToCart:h,removeFromCart:x}=(0,v.j)(),{toggleFavorite:P,isFavorite:j}=(0,_.r)(),{isAuthenticated:b}=(0,p.a)(),{toast:y}=(0,m.pm)(),w=(0,d.useRef)(null),C=(0,d.useRef)(null),[N,R]=(0,d.useState)(!1),[k,B]=(0,d.useState)(null),[T,E]=(0,d.useState)(!1),[A,F]=(0,d.useState)(!1),S=(0,d.useRef)(null),L=(0,d.useRef)(null),O=(0,d.useRef)(null),W=(0,d.useRef)(null),z=(0,d.useRef)(null),M=(0,d.useRef)(!0),[X,D]=(0,d.useState)(!1),Z=b&&j(r.id),q=f.some(e=>e.id===r.id);(0,d.useEffect)(()=>{let e=w.current;if(!e)return;let t=getCardObserver();if(t)return t.observe(e),()=>{t.unobserve(e)}},[]),(0,d.useEffect)(()=>(D(!0),()=>{M.current=!1,S.current&&clearTimeout(S.current),L.current&&clearTimeout(L.current),O.current&&(cancelAnimationFrame(O.current),O.current=null),W.current&&clearTimeout(W.current),z.current&&clearTimeout(z.current)}),[]);let triggerButtonAnimation=()=>{S.current&&clearTimeout(S.current),R(!0),S.current=setTimeout(()=>{R(!1)},220)},triggerFlightAnimation=()=>{if(!C.current)return;let e=document.querySelector('[data-av-cart-target="icon"]');if(!e)return;let t=C.current.getBoundingClientRect(),a=e.getBoundingClientRect(),r=window.scrollX||window.pageXOffset||0,c=window.scrollY||window.pageYOffset||0,n=t.left+t.width/2,i=t.top+t.height/2,s=a.left+a.width/2,o=a.top+a.height/2,l={key:Date.now(),left:n+r,top:i+c,deltaX:s-n,deltaY:o-i};L.current&&clearTimeout(L.current),O.current&&(cancelAnimationFrame(O.current),O.current=null),B(null),O.current=window.requestAnimationFrame(()=>{M.current&&(B(l),O.current=null,L.current=setTimeout(()=>{M.current&&B(null)},450))})};return(0,d.useEffect)(()=>{if(!k)return;let handleResize=()=>{M.current&&B(null)};return window.addEventListener("resize",handleResize),()=>{window.removeEventListener("resize",handleResize)}},[k]),(0,c.jsxs)("div",{ref:w,"data-av-card":!0,className:"".concat(g().card," av-card av-card-w av-card-hover ").concat(n).trim(),children:[(0,c.jsxs)("div",{className:"av-card-media ".concat(g().imageWrapper),children:["number"==typeof r.rating?(0,c.jsxs)("span",{className:g().avRatingBadge,"aria-label":"Средняя оценка ".concat(r.rating.toFixed(1)," из 5"),children:[null!==(a=null===(t=r.rating)||void 0===t?void 0:t.toFixed(1))&&void 0!==a?a:"—"," ★"]}):null,(0,c.jsx)(o(),{src:r.image,alt:r.name,fill:!0,sizes:"(max-width: 768px) 50vw, 240px",className:"av-card-img",style:{objectFit:"contain"}}),(0,c.jsx)("button",{type:"button",className:"".concat(g()["av-fav-btn"]," ").concat(Z?g()["av-fav-btn-active"]:""," ").concat(T?g()["av-fav-btn-pulse"]:""," ").concat(A?g()["av-fav-btn-shake"]:""),"aria-pressed":Z,"aria-label":Z?"Убрать из избранного":"Добавить в избранное",onClick:e=>{if(e.preventDefault(),e.stopPropagation(),!b){F(!0),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{F(!1)},320),y({type:"warning",message:"Войдите в аккаунт, чтобы добавлять в избранное",actionLabel:"Войти",onAction:()=>{s.push("/auth/login?returnTo=/favorites")}});return}let t=P(r.id);W.current&&clearTimeout(W.current),E(!0),W.current=setTimeout(()=>{E(!1)},220),y({type:"success",message:t?"Товар добавлен в избранное":"Товар удалён из избранного"})},children:(0,c.jsx)("svg",{className:g()["av-fav-icon"],viewBox:"0 0 24 24",role:"presentation","aria-hidden":"true",children:(0,c.jsx)("path",{d:"M12 20.7 10.55 19.4C5.4 14.8 2 11.7 2 8A5 5 0 0 1 7 3a4.5 4.5 0 0 1 5 3 4.5 4.5 0 0 1 5-3 5 5 0 0 1 5 5c0 3.7-3.4 6.8-8.55 11.4Z"})})})]}),(0,c.jsxs)("div",{className:"av-card-body ".concat(g().content),children:[(0,c.jsx)("h3",{className:"av-clamp-2",children:r.name}),(0,c.jsx)("p",{className:"".concat(g().description," av-clamp-3"),children:r.description}),(0,c.jsxs)("div",{className:"".concat(g().footer," av-card-footer"),children:[(0,c.jsxs)("span",{className:g().price,children:[r.price.toLocaleString()," ₺"]}),(0,c.jsxs)("div",{className:"".concat(g().actions," av-card-actions"),children:[(0,c.jsx)("button",{type:"button",ref:C,className:"".concat(g().cartButton," ").concat(q?g()["av-in-cart"]:""," ").concat(N?g()["av-cart-button-pulse"]:"").trim(),onClick:e=>{if(e&&(e.preventDefault(),e.stopPropagation()),q){x(r.id),y({type:"success",message:"".concat(r.name," удалён из корзины")});return}h(r,1),triggerButtonAnimation(),triggerFlightAnimation(),y({type:"success",message:"".concat(r.name," добавлен в корзину")})},"aria-label":q?"Удалить ".concat(r.name," из корзины"):"Добавить ".concat(r.name," в корзину"),children:q?"В корзине":"В корзину"}),(0,c.jsx)(i(),{href:"/products/".concat(r.id),className:"".concat(g().more," av-btn-center"),children:"Подробнее"})]})]})]}),X&&k?(0,u.createPortal)((0,c.jsx)("span",{className:"".concat(g()["av-flyer"]," ").concat(g()["av-flyer-active"]),style:{left:"".concat(k.left,"px"),top:"".concat(k.top,"px"),"--av-flyer-x":"".concat(k.deltaX,"px"),"--av-flyer-y":"".concat(k.deltaY,"px")},"aria-hidden":"true"},k.key),document.body):null]})}},81:function(e,t,a){"use strict";a.r(t);var r=a(5893),c=a(7294),n=a(1163),i=a(5675),s=a.n(i),o=a(3207),l=a(1622),u=a(1187),d=a(97),v=a(5099),_=a(1286),p=a(9357),m=a(9495),f=a.n(m);t.default=()=>{let e=(0,n.useRouter)(),{id:t}=e.query,a=t?(0,u.gk)(t):null,{addToCart:i}=(0,d.j)(),{toast:m}=(0,v.pm)(),{isAuthenticated:g}=(0,_.a)(),[h,x]=(0,c.useState)((null==a?void 0:a.rating)||0),[P,j]=(0,c.useState)(null);(0,c.useEffect)(()=>{a&&x(a.rating||0)},[a]);let b=(0,c.useMemo)(()=>a?u.RB.filter(e=>e.category===a.category&&e.id!==a.id).slice(0,4):[],[a]);if(!a)return(0,r.jsx)(o.Z,{title:"Товар не найден",children:(0,r.jsx)("div",{className:f().empty,children:(0,r.jsx)("p",{children:"Товар не найден или загружается..."})})});let y=null!=P?P:h||0,handleRate=e=>{if(!g){m({type:"warning",message:"Только авторизованные пользователи могут ставить оценку"}),j(null);return}x(e),j(null),m({type:"success",message:"Спасибо за оценку ".concat(e," из 5")})};return(0,r.jsxs)(o.Z,{title:"".concat(a.name," — Avenue Beauty"),children:[(0,r.jsxs)(p.Z,{className:"".concat(f().productSection," av-top-trim"),children:[(0,r.jsx)("div",{className:f().imageWrapper,children:(0,r.jsx)(s(),{src:a.image,alt:a.name,fill:!0,sizes:"(max-width: 768px) 80vw, 400px",style:{objectFit:"contain"}})}),(0,r.jsxs)("div",{className:f().info,children:[(0,r.jsx)("h1",{children:a.name}),(0,r.jsx)("p",{className:f().description,children:a.description}),(0,r.jsxs)("p",{className:f().price,children:[a.price.toLocaleString()," ₺"]}),(0,r.jsx)("button",{className:f().addButton,onClick:()=>{i(a,1),m({type:"success",message:"".concat(a.name," добавлен в корзину")}),e.push("/cart")},children:"Добавить в корзину"}),(0,r.jsxs)("div",{className:f()["av-product-rating"],children:[(0,r.jsx)("h3",{children:"Оцените этот товар"}),(0,r.jsx)("div",{className:f()["av-stars"],role:"radiogroup","aria-label":"Оценка товара",children:[1,2,3,4,5].map(e=>{let t=y>=e;return(0,r.jsx)("button",{type:"button",className:"".concat(f()["av-star"]," ").concat(t?f()["av-star-active"]:"").trim(),onMouseEnter:()=>j(e),onMouseLeave:()=>j(null),onFocus:()=>j(e),onBlur:()=>j(null),onClick:()=>handleRate(e),role:"radio","aria-label":"Оценить на ".concat(e," из 5"),"aria-checked":h===e,children:(0,r.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:(0,r.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})})},e)})}),g?null:(0,r.jsx)("p",{className:f()["av-rating-note"],children:"Только авторизованные пользователи могут ставить оценку"})]})]})]}),b.length>0&&(0,r.jsxs)(p.Z,{className:f()["av-related"],children:[(0,r.jsx)("h2",{children:"Похожие товары"}),(0,r.jsx)("div",{className:"av-grid-shell",children:(0,r.jsx)("div",{className:"av-grid-products",children:b.map(e=>(0,r.jsx)(l.Z,{product:e},e.id))})}),(0,r.jsx)("p",{className:f()["av-related-hint"],children:g?"Оцените товар или добавьте его в избранное ❤️":"Войдите, чтобы оценивать и добавлять в избранное"})]})]})}},2637:function(e){e.exports={card:"ProductCard_card__2hfhB",imageWrapper:"ProductCard_imageWrapper__A_6g4",avRatingBadge:"ProductCard_avRatingBadge__7OvUr","av-fav-btn":"ProductCard_av-fav-btn__nUD0d",content:"ProductCard_content__vyu2e",description:"ProductCard_description__JmjJL",footer:"ProductCard_footer__aGQww",price:"ProductCard_price__s3DmM",actions:"ProductCard_actions__DOKvR",cartButton:"ProductCard_cartButton__1_56F","av-in-cart":"ProductCard_av-in-cart__EzKUF","av-cart-button-pulse":"ProductCard_av-cart-button-pulse__t4qDr",more:"ProductCard_more__c8_H9","av-flyer":"ProductCard_av-flyer__WyhFX","av-flyer-active":"ProductCard_av-flyer-active__w7Ucu","av-flyer-motion":"ProductCard_av-flyer-motion__5hflv","av-fav-btn-active":"ProductCard_av-fav-btn-active__gHpEH","av-fav-icon":"ProductCard_av-fav-icon__xtYdR","av-fav-btn-pulse":"ProductCard_av-fav-btn-pulse__mQYPa","av-fav-pop":"ProductCard_av-fav-pop__jkfWC","av-fav-btn-shake":"ProductCard_av-fav-btn-shake__ltCWx","av-fav-shake":"ProductCard_av-fav-shake__2otdp"}},9495:function(e){e.exports={productSection:"ProductPage_productSection__uQLTb",imageWrapper:"ProductPage_imageWrapper__3p1ck",info:"ProductPage_info__dowqM",description:"ProductPage_description__c_t2q",price:"ProductPage_price__AjrVp","av-product-rating":"ProductPage_av-product-rating__G4O5M","av-stars":"ProductPage_av-stars__iPBAG","av-star":"ProductPage_av-star__k6ucX","av-star-active":"ProductPage_av-star-active__NIJdp","av-rating-note":"ProductPage_av-rating-note__Qy5Th",addButton:"ProductPage_addButton__cE3e2",empty:"ProductPage_empty__I4awO","av-related":"ProductPage_av-related__WTHt6","av-related-hint":"ProductPage_av-related-hint__nC8cK"}}},function(e){e.O(0,[998,675,207,187,774,888,179],function(){return e(e.s=8693)}),_N_E=e.O()}]);