(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{1118:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(8559)}])},1286:function(e,t,r){"use strict";r.d(t,{H:function(){return AuthProvider},a:function(){return useAuth}});var a=r(5893),s=r(7294);let o="avenue-auth",n=(0,s.createContext)({user:null,register:()=>{},login:()=>{},logout:()=>{},updateProfile:()=>{},changeEmail:()=>{},changePassword:()=>{}}),AuthProvider=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=window.localStorage.getItem(o);if(e)try{let t=JSON.parse(e);t.currentUser&&i(t.currentUser)}catch(e){console.warn("Ошибка чтения данных авторизации",e)}},[]),(0,s.useEffect)(()=>{let e=window.localStorage.getItem(o),t=e?JSON.parse(e):{users:[],currentUser:null};t.currentUser=r,window.localStorage.setItem(o,JSON.stringify(t))},[r]);let register=e=>{let{name:t,email:r,password:a,firstName:s="",lastName:n="",phone:u=""}=e,l=window.localStorage.getItem(o),c=l?JSON.parse(l):{users:[],currentUser:null},d=c.users.find(e=>e.email===r);if(d)throw Error("Пользователь с таким email уже зарегистрирован");let v={name:t,email:r,password:a,firstName:s,lastName:n,phone:u},m={users:[...c.users,v],currentUser:v};return window.localStorage.setItem(o,JSON.stringify(m)),i(v),!0},login=e=>{let{email:t,password:r}=e,a=window.localStorage.getItem(o),s=a?JSON.parse(a):{users:[],currentUser:null},n=s.users.find(e=>e.email===t&&e.password===r);if(!n)throw Error("Неверный email или пароль");let u={...s,currentUser:n};return window.localStorage.setItem(o,JSON.stringify(u)),i(n),!0},logout=()=>{i(null)},withStoredData=e=>{let t=window.localStorage.getItem(o),r=t?JSON.parse(t):{users:[],currentUser:null};if(!r.currentUser)throw Error("Пользователь не авторизован");let a=e(r);return window.localStorage.setItem(o,JSON.stringify(r)),a},updateProfile=e=>{if(!r)throw Error("Пользователь не авторизован");let t=withStoredData(t=>{let r={...t.currentUser,...e};return t.users=t.users.map(e=>e.email===t.currentUser.email?r:e),t.currentUser=r,i(r),r});return t},changeEmail=e=>{if(!e)throw Error("Укажите email");let t=e.trim(),r=withStoredData(e=>{let r=e.currentUser.email,a=e.users.find(e=>e.email===t&&e.email!==r);if(a)throw Error("Email уже используется другим аккаунтом");let s={...e.currentUser,email:t};return e.users=e.users.map(e=>e.email===r?s:e),e.currentUser=s,i(s),s});return r},changePassword=e=>{let{oldPassword:t,newPassword:r}=e;if(!t||!r)throw Error("Введите текущий и новый пароль");let a=withStoredData(e=>{if(e.currentUser.password!==t)throw Error("Текущий пароль указан неверно");let a={...e.currentUser,password:r};return e.users=e.users.map(t=>t.email===e.currentUser.email?a:t),e.currentUser=a,i(a),!0});return a},u=(0,s.useMemo)(()=>({user:r,register,login,logout,updateProfile,changeEmail,changePassword,isAuthenticated:!!r}),[r]);return(0,a.jsx)(n.Provider,{value:u,children:t})},useAuth=()=>(0,s.useContext)(n)},97:function(e,t,r){"use strict";r.d(t,{Z:function(){return CartProvider},j:function(){return useCart}});var a=r(5893),s=r(7294);let o="avenue-cart",n=(0,s.createContext)({items:[],addToCart:()=>{},updateQuantity:()=>{},removeFromCart:()=>{},clearCart:()=>{},total:0,count:0}),i=[],reducer=(e,t)=>{switch(t.type){case"INITIALIZE":return t.payload;case"ADD":{let r=e.find(e=>e.id===t.payload.id);if(r)return e.map(e=>e.id===t.payload.id?{...e,quantity:e.quantity+t.payload.quantity}:e);return[...e,t.payload]}case"UPDATE":return e.map(e=>e.id===t.payload.id?{...e,quantity:t.payload.quantity}:e).filter(e=>e.quantity>0);case"REMOVE":return e.filter(e=>e.id!==t.payload);case"CLEAR":return[];default:return e}},CartProvider=e=>{let{children:t}=e,[r,u]=(0,s.useReducer)(reducer,i);(0,s.useEffect)(()=>{let e=window.localStorage.getItem(o);if(e)try{let t=JSON.parse(e);Array.isArray(t)&&u({type:"INITIALIZE",payload:t})}catch(e){console.warn("Ошибка чтения корзины",e)}},[]),(0,s.useEffect)(()=>{window.localStorage.setItem(o,JSON.stringify(r))},[r]);let addToCart=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;u({type:"ADD",payload:{...e,quantity:t}})},updateQuantity=(e,t)=>{let r=Number.isFinite(t)&&t>0?t:1;u({type:"UPDATE",payload:{id:e,quantity:r}})},removeFromCart=e=>{u({type:"REMOVE",payload:e})},clearCart=()=>u({type:"CLEAR"}),l=(0,s.useMemo)(()=>r.reduce((e,t)=>e+t.price*t.quantity,0),[r]),c=(0,s.useMemo)(()=>r.reduce((e,t)=>e+t.quantity,0),[r]),d=(0,s.useMemo)(()=>({items:r,addToCart,updateQuantity,removeFromCart,clearCart,total:l,count:c}),[r,l,c]);return(0,a.jsx)(n.Provider,{value:d,children:t})},useCart=()=>(0,s.useContext)(n)},8290:function(e,t,r){"use strict";r.d(t,{c:function(){return FavoritesProvider},r:function(){return useFavorites}});var a=r(5893),s=r(7294);let o="avenue-favorites",n=(0,s.createContext)({favoriteIds:[],favorites:[],toggleFavorite:()=>!1,isFavorite:()=>!1}),FavoritesProvider=e=>{let{children:t}=e,[r,i]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=window.localStorage.getItem(o);if(e)try{let t=JSON.parse(e);if(Array.isArray(t)){let e=Date.now(),r=t.map((t,r)=>{if("string"==typeof t)return{id:t,addedAt:e+r};if(t&&"string"==typeof t.id){let a=Number(t.addedAt);return{id:t.id,addedAt:Number.isFinite(a)?a:e+r}}return null}).filter(Boolean);i(r)}}catch(e){console.warn("Ошибка чтения избранного",e)}},[]),(0,s.useEffect)(()=>{window.localStorage.setItem(o,JSON.stringify(r))},[r]);let u=(0,s.useCallback)(e=>{let t=!1;return i(r=>{let a=r.find(t=>t.id===e);if(a)return t=!1,r.filter(t=>t.id!==e);let s={id:e,addedAt:Date.now()};return t=!0,[...r,s]}),t},[]),l=(0,s.useMemo)(()=>r.map(e=>e.id),[r]),c=(0,s.useCallback)(e=>l.includes(e),[l]),d=(0,s.useMemo)(()=>({favorites:r,favoriteIds:l,toggleFavorite:u,isFavorite:c}),[r,l,u,c]);return(0,a.jsx)(n.Provider,{value:d,children:t})},useFavorites=()=>(0,s.useContext)(n)},5099:function(e,t,r){"use strict";r.d(t,{VW:function(){return ToastProvider},pm:function(){return useToast}});var a=r(5893),s=r(7294),o=r(2899),n=r.n(o);let i={success:(0,a.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M9.5 16.2 5.8 12.5l1.4-1.4 2.3 2.3 7-7 1.4 1.4-8.4 8.4z"})}),warning:(0,a.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M12 2 1 22h22L12 2zm1 15h-2v-2h2v2zm0-4h-2V9h2v4z"})}),error:(0,a.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M12 2 1 22h22L12 2zm1 15h-2v-2h2v2zm0-4h-2V9h2v4z"})}),info:(0,a.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})},ToastItem=e=>{var t;let{toast:r,onDismiss:o}=e,u=null!==(t=r.duration)&&void 0!==t?t:3600,[l,c]=(0,s.useState)(!1),d=(0,s.useRef)(null),v=(0,s.useRef)(null),m=(0,s.useRef)(u),f=(0,s.useRef)(!1),clearTimer=()=>{d.current&&(clearTimeout(d.current),d.current=null)},h=(0,s.useCallback)(()=>{f.current||(f.current=!0,c(!0),clearTimer(),setTimeout(()=>{o(r.id)},200))},[o,r.id]),p=(0,s.useCallback)(()=>{!Number.isFinite(u)||u<=0||f.current||(v.current=Date.now(),clearTimer(),d.current=setTimeout(()=>{h()},m.current))},[u,h]);(0,s.useEffect)(()=>(m.current=u,p(),()=>{clearTimer()}),[u,p]);let _="error"===r.type||"warning"===r.type?"alert":"status",g="error"===r.type||"warning"===r.type?"assertive":"polite";return(0,a.jsxs)("div",{className:"".concat(n()["av-toast"]," ").concat(n()["av-toast-".concat(r.type)]||""," ").concat(l?n()["av-toast-leave"]:n()["av-toast-enter"]),onMouseEnter:()=>{if(!d.current||!v.current)return;let e=Date.now()-v.current;m.current=Math.max(1200,m.current-e),clearTimer()},onMouseLeave:()=>{p()},role:_,"aria-live":g,children:[(0,a.jsx)("div",{className:n()["av-toast-icon"],"aria-hidden":"true",children:i[r.type]||i.info}),(0,a.jsxs)("div",{className:n()["av-toast-content"],children:[r.title?(0,a.jsx)("p",{className:n()["av-toast-title"],children:r.title}):null,(0,a.jsx)("p",{className:n()["av-toast-message"],children:r.message}),r.actionLabel?(0,a.jsx)("button",{type:"button",className:n()["av-toast-action"],onClick:()=>{r.onAction&&r.onAction(),h()},children:r.actionLabel}):null]}),(0,a.jsx)("button",{type:"button",className:n()["av-toast-close"],onClick:()=>{h()},"aria-label":"Закрыть уведомление",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{d:"m7 7 10 10m0-10L7 17"})})})]})};var components_Toaster=e=>{let{toasts:t,onDismiss:r}=e;return t&&0!==t.length?(0,a.jsx)("div",{className:"av-toaster fixed right-4 bottom-4 z-[2000] md:right-6 md:bottom-6",children:(0,a.jsx)("div",{className:n()["av-toaster"],children:(0,a.jsx)("div",{className:n()["av-toast-viewport"],"aria-live":"polite","aria-relevant":"additions removals",children:t.map(e=>(0,a.jsx)(ToastItem,{toast:e,onDismiss:r},e.id))})})}):null};let u=(0,s.createContext)(null),createId=()=>"toast-".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2)),ToastProvider=e=>{let{children:t}=e,[r,o]=(0,s.useState)([]),n=(0,s.useCallback)(e=>{o(t=>t.filter(t=>t.id!==e))},[]),i=(0,s.useCallback)(e=>{if(!e||!e.message)return null;let t=createId(),r=Number.isFinite(e.duration)?Math.max(e.duration,1e3):3600,a={id:t,title:e.title||"",message:e.message,type:e.type||"info",actionLabel:e.actionLabel,onAction:e.onAction,duration:r};return o(e=>[...e,a]),t},[]),l=(0,s.useMemo)(()=>({toast:i,dismiss:n,toasts:r}),[i,n,r]);return(0,a.jsxs)(u.Provider,{value:l,children:[t,(0,a.jsx)(components_Toaster,{toasts:r,onDismiss:n})]})},useToast=()=>{let e=(0,s.useContext)(u);if(!e)throw Error("useToast должен использоваться внутри ToastProvider");return{toast:e.toast,dismiss:e.dismiss}}},8559:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _app}});var a=r(5893),s=r(7294),o=r(1163);function RootLoading(){return(0,a.jsx)("div",{className:"av-route-loader",children:(0,a.jsx)("div",{className:"av-loader",children:(0,a.jsx)("div",{className:"av-loader-spinner"})})})}r(4470);var n=r(1286),i=r(97),u=r(8290),l=r(5099),_app=function(e){let{Component:t,pageProps:r}=e,c=(0,o.useRouter)(),[d,v]=(0,s.useState)(!1),m=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=!0,handleStart=t=>{t!==c.asPath&&(m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{m.current=null,e&&v(!0)},120))},handleStop=()=>{m.current&&(clearTimeout(m.current),m.current=null),e&&v(!1)};return c.events.on("routeChangeStart",handleStart),c.events.on("routeChangeComplete",handleStop),c.events.on("routeChangeError",handleStop),()=>{e=!1,m.current&&(clearTimeout(m.current),m.current=null),c.events.off("routeChangeStart",handleStart),c.events.off("routeChangeComplete",handleStop),c.events.off("routeChangeError",handleStop)}},[c]),(0,a.jsx)(l.VW,{children:(0,a.jsx)(n.H,{children:(0,a.jsx)(i.Z,{children:(0,a.jsxs)(u.c,{children:[d?(0,a.jsx)(RootLoading,{}):null,(0,a.jsx)(t,{...r})]})})})})}},4470:function(){},2899:function(e){e.exports={"av-toaster":"Toast_av-toaster__FpggH","av-toast-viewport":"Toast_av-toast-viewport__4OJKO","av-toast":"Toast_av-toast__W3Iad","av-toast-enter":"Toast_av-toast-enter__ayDL_","av-toast-in":"Toast_av-toast-in__wBk7o","av-toast-leave":"Toast_av-toast-leave__LaTtw","av-toast-out":"Toast_av-toast-out__mlbfo","av-toast-icon":"Toast_av-toast-icon__LLqy8","av-toast-content":"Toast_av-toast-content__rNvju","av-toast-title":"Toast_av-toast-title__XOEuJ","av-toast-message":"Toast_av-toast-message__zyr07","av-toast-action":"Toast_av-toast-action__a1DQD","av-toast-close":"Toast_av-toast-close__hZ8mU","av-toast-success":"Toast_av-toast-success__agpU1","av-toast-warning":"Toast_av-toast-warning__F2Xg_","av-toast-error":"Toast_av-toast-error___OweY","av-toast-info":"Toast_av-toast-info__XlUFU"}},1163:function(e,t,r){e.exports=r(4751)}},function(e){var __webpack_exec__=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return __webpack_exec__(1118),__webpack_exec__(4751)}),_N_E=e.O()}]);