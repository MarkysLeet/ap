(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{8086:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return t(4768)}])},4768:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return cart}});var s=t(5893),r=t(7294),i=t(1163),n=t(3207),d=t(1664),l=t.n(d),c=t(5675),u=t.n(c),o=t(4566),_=t.n(o),components_CartItem=e=>{let{item:a,onUpdate:t,onRemove:r}=e;return(0,s.jsxs)("div",{className:_().item,children:[(0,s.jsxs)(l(),{href:"/products/".concat(a.id),className:_()["av-cart-link"],"aria-label":"Перейти к товару ".concat(a.name),children:[(0,s.jsx)("div",{className:_().imageWrapper,children:(0,s.jsx)(u(),{src:a.image,alt:a.name,fill:!0,sizes:"(max-width: 768px) 25vw, 120px",style:{objectFit:"contain"}})}),(0,s.jsx)("span",{className:_()["av-cart-title"],children:a.name})]}),(0,s.jsxs)("p",{className:_().price,children:[a.price.toLocaleString()," ₺"]}),(0,s.jsxs)("div",{className:_().controls,children:[(0,s.jsxs)("label",{className:_().quantityLabel,children:["Количество",(0,s.jsx)("input",{type:"number",min:"1",value:a.quantity,onChange:e=>t(a.id,Number(e.target.value))})]}),(0,s.jsx)("button",{className:_().removeButton,onClick:()=>r(a.id),children:"Удалить"})]})]})},m=t(97),h=t(1286),v=t(3625),p=t(7345),f=t.n(p),cart=()=>{let{items:e,total:a,updateQuantity:t,removeFromCart:d,clearCart:l}=(0,m.j)(),{isAuthenticated:c}=(0,h.a)(),u=(0,i.useRouter)(),[o,_]=(0,r.useState)([]),[p,x]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=(0,v.zz)(),a=(0,v.y)(e.addresses);_(a.addresses);let t=a.addresses.find(e=>e.isDefault);x(t?t.id:"")},[]);let j=o.find(e=>e.id===p);return(0,s.jsx)(n.Z,{title:"Корзина — Avenue Beauty",children:(0,s.jsxs)("section",{className:f().section,children:[(0,s.jsx)("h1",{children:"Корзина"}),0===e.length?(0,s.jsx)("p",{className:f().empty,children:"Ваша корзина пуста. Добавьте товары из каталога."}):(0,s.jsxs)("div",{className:f().cartWrapper,children:[(0,s.jsx)("div",{className:f().itemsList,children:e.map(e=>(0,s.jsx)(components_CartItem,{item:e,onUpdate:t,onRemove:d},e.id))}),(0,s.jsxs)("aside",{className:f().summary,children:[(0,s.jsx)("h2",{children:"Итого"}),(0,s.jsxs)("p",{className:f().total,children:[a.toLocaleString()," ₺"]}),o.length>0?(0,s.jsxs)("div",{className:f()["av-cart-address"],children:[(0,s.jsx)("label",{htmlFor:"cart-address-select",children:"Адрес доставки"}),(0,s.jsx)("select",{id:"cart-address-select",value:p,onChange:e=>{x(e.target.value)},className:f()["av-cart-address__select"],children:o.map(e=>(0,s.jsx)("option",{value:e.id,children:e.label},e.id))}),j?(0,s.jsx)("p",{className:f()["av-cart-address__preview"],children:[j.country,j.city,j.street].filter(Boolean).join(", ")||"Уточните адрес в личном кабинете"}):null]}):(0,s.jsxs)("div",{className:f()["av-cart-address-empty"],children:[(0,s.jsx)("p",{children:"Добавьте адрес доставки в личном кабинете, чтобы выбрать его при оформлении."}),(0,s.jsx)("button",{type:"button",className:f()["av-cart-address-empty__cta"],onClick:()=>u.push("/account?tab=address"),children:"Добавить адрес"})]}),(0,s.jsx)("button",{className:f().checkoutButton,onClick:l,children:"Очистить корзину"}),(0,s.jsx)("p",{className:f().notice,children:"Оплата появится позже. Мы уже готовим интеграцию с платежной системой."})]})]}),!c&&e.length>0?(0,s.jsxs)("section",{className:f()["av-auth-hint"],children:[(0,s.jsx)("div",{className:f()["av-auth-hint__icon"],"aria-hidden":"true",children:(0,s.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",children:[(0,s.jsx)("path",{d:"M12 3a5 5 0 0 1 5 5v2h1a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-6a3 3 0 0 1 3-3h1V8a5 5 0 0 1 5-5Z"}),(0,s.jsx)("path",{d:"M9 21v-6a3 3 0 0 1 6 0v6"})]})}),(0,s.jsxs)("div",{className:f()["av-auth-hint__content"],children:[(0,s.jsx)("h3",{children:"Чтобы оформить покупку и сохранить корзину, войдите в аккаунт"}),(0,s.jsx)("button",{type:"button",className:f()["av-auth-hint__cta"],onClick:()=>u.push("/auth/login?returnTo=/cart"),children:"Войти"})]})]}):null]})})}},3625:function(e,a,t){"use strict";t.d(a,{H7:function(){return writeAddresses},y:function(){return ensureDefaultAddress},zz:function(){return readAddresses}});let s="avenue-account-addresses",r={addresses:[],defaultId:null},normalizeAddress=(e,a)=>({id:e.id||"address-".concat(Date.now(),"-").concat(a),label:e.label||"Адрес",country:e.country||"",city:e.city||"",street:e.street||"",postalCode:e.postalCode||"",isDefault:!!e.isDefault}),readAddresses=()=>{let e=window.localStorage.getItem(s);if(!e)return r;try{var a,t,i,n;let s=JSON.parse(e);if(Array.isArray(s)){let e=s.map(normalizeAddress),r=(null===(a=e.find(e=>e.isDefault))||void 0===a?void 0:a.id)||(null===(t=e[0])||void 0===t?void 0:t.id)||null;return{addresses:e.map(e=>({...e,isDefault:e.id===r})),defaultId:r}}if(s&&Array.isArray(s.addresses)){let e=s.addresses.map(normalizeAddress),a=s.defaultId||(null===(i=e.find(e=>e.isDefault))||void 0===i?void 0:i.id)||(null===(n=e[0])||void 0===n?void 0:n.id)||null;return{addresses:e.map(e=>({...e,isDefault:e.id===a})),defaultId:a}}if(s&&"object"==typeof s){let e=normalizeAddress(s,0);return{addresses:[{...e,isDefault:!0}],defaultId:e.id}}}catch(e){console.warn("Ошибка чтения адресов",e)}return r},writeAddresses=e=>{var a,t;let r=e.map((e,a)=>normalizeAddress(e,a)),i=(null===(a=r.find(e=>e.isDefault))||void 0===a?void 0:a.id)||(null===(t=r[0])||void 0===t?void 0:t.id)||null,n={addresses:r.map(e=>({...e,isDefault:e.id===i})),defaultId:i};window.localStorage.setItem(s,JSON.stringify(n))},ensureDefaultAddress=e=>{if(!Array.isArray(e)||0===e.length)return{addresses:[],defaultId:null};let a=e.find(e=>e.isDefault);if(a)return{addresses:e.map(e=>({...e,isDefault:e.id===a.id})),defaultId:a.id};let[t,...s]=e;return{addresses:[{...t,isDefault:!0},...s.map(e=>({...e,isDefault:!1}))],defaultId:t.id}}},4566:function(e){e.exports={item:"CartItem_item__YFMeg",imageWrapper:"CartItem_imageWrapper__XvK7t","av-cart-link":"CartItem_av-cart-link__U_Ct4","av-cart-title":"CartItem_av-cart-title__gu2_H",price:"CartItem_price__teOqZ",controls:"CartItem_controls__tXi_s",quantityLabel:"CartItem_quantityLabel__PHHYA",removeButton:"CartItem_removeButton__0Bt3h"}},7345:function(e){e.exports={section:"CartPage_section__yxawS",cartWrapper:"CartPage_cartWrapper__eqmVP",itemsList:"CartPage_itemsList__mlLhx",summary:"CartPage_summary___m6VR",total:"CartPage_total__HxQWG","av-cart-address":"CartPage_av-cart-address__nBJkS","av-cart-address__select":"CartPage_av-cart-address__select__rMrXB","av-cart-address__preview":"CartPage_av-cart-address__preview__xxgn0","av-cart-address-empty":"CartPage_av-cart-address-empty__C9sj7","av-cart-address-empty__cta":"CartPage_av-cart-address-empty__cta__2A_Ya",checkoutButton:"CartPage_checkoutButton__7LWoq",notice:"CartPage_notice__NEfLe",empty:"CartPage_empty__B3Ncx","av-auth-hint":"CartPage_av-auth-hint__BKTY_","av-auth-hint__icon":"CartPage_av-auth-hint__icon___MVvI","av-auth-hint__content":"CartPage_av-auth-hint__content__VTciK","av-auth-hint__cta":"CartPage_av-auth-hint__cta__TmYQG"}}},function(e){e.O(0,[998,675,207,774,888,179],function(){return e(e.s=8086)}),_N_E=e.O()}]);